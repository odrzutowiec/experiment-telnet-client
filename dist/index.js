!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=16)}([function(t,e){t.exports=require("buffer")},function(t,e){t.exports=require("babel-runtime/helpers/inherits")},function(t,e){t.exports=require("babel-runtime/helpers/possibleConstructorReturn")},function(t,e){t.exports=require("babel-runtime/helpers/createClass")},function(t,e){t.exports=require("babel-runtime/helpers/classCallCheck")},function(t,e){t.exports=require("stream")},function(t,e){t.exports=require("net")},function(t,e){t.exports=require("events")},function(t,e){t.exports=require("babel-runtime/helpers/asyncToGenerator")},function(t,e){t.exports=require("babel-runtime/regenerator")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Telnet=e.TelnetStream=e.IAC=e.DONT=e.DO=e.WONT=e.WILL=e.SUBBEG=e.SUBEND=e.SUBCMD=e.SUBNEG=e.OPTION=e.COMMAND=void 0;var n=c(r(9)),i=c(r(8)),s=c(r(4)),o=c(r(3)),a=c(r(2)),u=c(r(1));function c(t){return t&&t.__esModule?t:{default:t}}var l=r(7),h=r(6),d=r(5),f=r(0).Buffer,p=e.COMMAND=Symbol(),m=e.OPTION=Symbol(),v=e.SUBNEG=Symbol(),b=e.SUBCMD=Symbol(),y=e.SUBEND=240,x=e.SUBBEG=250,S=e.WILL=251,g=e.WONT=252,k=e.DO=253,O=e.DONT=254,w=e.IAC=255,_=e.TelnetStream=function(t){function e(){(0,s.default)(this,e);var t=(0,a.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.setEncoding("utf8"),t.state=void 0,t.command=void 0,t.option=void 0,t.subcmd=[],t}return(0,u.default)(e,t),(0,o.default)(e,[{key:"_transform",value:function(t,e,r){var n=f.alloc(t.length),i=0,s=!0,o=!1,a=void 0;try{for(var u,c=t[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var l=u.value,h=this.handle(l);void 0!==h&&(n[i++]=h)}}catch(t){o=!0,a=t}finally{try{!s&&c.return&&c.return()}finally{if(o)throw a}}this.push(n),r()}},{key:"handle",value:function(t){switch(this.state){case p:switch(t){case S:case g:case k:case O:return this.command=t,void(this.state=m);case x:return this.command=x,void(this.state=m);default:return this.emit("command",{command:t}),void(this.state=void 0)}case m:return this.command===x?(this.option=t,void(this.state=v)):(this.emit("command",{command:this.command,option:t}),void(this.state=void 0));case v:switch(t){case w:return void(this.state=b);default:return void this.subcmd.push(t)}case b:switch(t){case w:return this.subcmd.push(w),void(this.state=v);case y:return this.emit("command",{command:this.command,option:this.option,subcmd:this.subcmd}),void(this.state=void 0);default:return console.error("error"),void(this.state=void 0)}case void 0:switch(this.state=void 0,this.command=void 0,this.option=void 0,this.subcmd=[],t){case w:return void(this.state=p);default:return t}}}}]),e}(d.Transform);e.Telnet=function(t){function e(t,r){(0,s.default)(this,e);var n=(0,a.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.socket=new h.Socket,n.out=new _,n.socket.addListener("close",function(t){return n.emit("close",t)}),n.out.addListener("data",function(t){return n.emit("data",t)}),n.out.addListener("command",function(t){return n.emit("command",t)}),n.socket.pipe(n.out),n.socket.connect(t,r),n}return(0,u.default)(e,t),(0,o.default)(e,[{key:"destroy",value:function(){this.socket.destroy()}},{key:"read",value:function(){var t=this;return new Promise(function(e){return t.once("data",function(t){return e(t)})}).catch(function(){return console.log("Failed read")})}},{key:"print",value:function(){var t=(0,i.default)(n.default.mark(function t(){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=process.stdout,t.next=3,this.read();case 3:t.t1=t.sent,t.t0.write.call(t.t0,t.t1);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"write",value:function(t){var e=this;return t=t instanceof Array?f.from(t):t,new Promise(function(r){return e.socket.write(t,r)}).catch(function(){return console.log("Failed to write: "+t)})}}]),e}(l)},function(t,e){t.exports=require("react-blessed")},function(t,e){t.exports=require("blessed")},function(t,e){t.exports=require("react")},function(t,e){t.exports=require("babel-runtime/helpers/toConsumableArray")},function(t,e){t.exports=require("babel-runtime/helpers/slicedToArray")},function(t,e,r){"use strict";var n=p(r(15)),i=p(r(14)),s=p(r(4)),o=p(r(3)),a=p(r(2)),u=p(r(1)),c=r(13),l=p(c),h=p(r(12)),d=r(11),f=(r(0),r(10));function p(t){return t&&t.__esModule?t:{default:t}}var m=function(t){function e(t){(0,s.default)(this,e);var r=(0,a.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.state={maxscroll:0,unseen:0,scroll:-1,input:"",output:[],history:[],pointer:void 0},t.screen.on("keypress",r.onInput.bind(r)),t.telnet.on("data",r.onOutput.bind(r)),r}return(0,u.default)(e,t),(0,o.default)(e,[{key:"componentDidMount",value:function(){this.refs.box.on("scroll",this.onScroll.bind(this))}},{key:"onInput",value:function(t,e){var r=this;switch(e.full){case"C-l":this.setState({output:[]});case"C-w":this.setState({pointer:void 0,input:this.state.input.replace(/(\w+|[^a-zA-Z\d\s:])\s*$/,"")});break;case"C-x":this.setState({pointer:void 0,input:""});break;case"C-p":if(0===this.state.history.length)break;if(void 0===this.state.pointer){this.setState({pointer:this.state.history.length-1,input:this.state.history[this.state.history.length-1]});break}var n=Math.max(this.state.pointer-1,0);this.setState({pointer:n,input:this.state.history[n]});break;case"C-n":if(0===this.state.history.length)break;if(void 0===this.state.pointer){this.setState({pointer:0,input:this.state.history[0]});break}var s=Math.min(this.state.pointer+1,this.state.history.length-1);this.setState({pointer:s,input:this.state.history[s]});break;case"backspace":this.setState(function(t){return{input:t.input.substring(0,t.input.length-1),pointer:void 0}});break;case"return":if(this.state.input.length>0){this.props.telnet.write(this.state.input+"\n");var o=this.state.input.replace(/[^\x20-\x7E]+/g,""),a=this.state.history.slice(-1)[0]===o;this.setState(function(t){return{input:"",output:[].concat((0,i.default)(t.output),[r.state.input+"\n"]),history:0===o.length||a?r.state.history:[].concat((0,i.default)(r.state.history),[o]),pointer:void 0}})}break;default:t&&this.setState(function(e){return{input:e.input+t,pointer:void 0}})}this.refs.box.setScrollPerc(100)}},{key:"onScroll",value:function(){var t=this.refs.box.getScrollHeight()-1,e=this.refs.box.getScroll(),r=e>=t?-1:e;this.setState({maxscroll:t,scroll:r,unseen:-1===r?0:this.state.unseen})}},{key:"onOutput",value:function(t){var e=this;this.setState(function(r){return{output:[].concat((0,i.default)(r.output),[t]),unseen:-1!==e.state.scroll?r.unseen+1:0,maxscroll:e.refs.box.getScrollHeight()-1}}),-1===this.state.scroll&&this.refs.box.setScrollPerc(100)}},{key:"render",value:function(){var t=this.state.history.length,e=void 0!==this.state.pointer?this.state.pointer+1+"/"+t+": ":"",r=this.state.output.map(function(t){return t}).join("").replace(/[\r]/g,""),n=this.state.output[this.state.output.length-1],i=""+e+this.state.input,s=this.state.unseen,o=this.state.scroll,a=this.state.maxscroll;return l.default.createElement("box",{width:"100%",height:"100%",style:{fg:"#3d2516"},ch:"/"},l.default.createElement("box",{ref:"box",scrollable:!0,mouse:!0,top:0,left:"center",width:"100%",height:"100%",content:""+r+i}),(s>0||-1!==o)&&l.default.createElement("box",{top:0,right:0,height:1,width:"100%",style:{},content:"[unseen: "+s+", scroll: "+o+"/"+a+"]: "+n}))}}]),e}(c.Component),v=process.argv.slice(2),b=(0,n.default)(v,2),y=b[0],x=b[1],S=new f.Telnet(x||23,y);S.on("close",function(){console.log("\nBye now!"),process.exit()});var g=h.default.screen({smartCSR:!0,terminal:"xterm-256color",fullUnicode:!0});g.key(["C-c"],function(t,e){process.exit()}),(0,d.render)(l.default.createElement(m,{screen:g,telnet:S}),g)}]);